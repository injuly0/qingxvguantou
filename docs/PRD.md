
# MoodFlow 产品需求文档 (PRD)

## 1. 项目概述
**项目名称**: MoodFlow
**核心理念**: 结合沉浸式视觉体验与积极心理学（VIA 24项性格优势）的情绪记录工具。
**主要功能**: 用户通过沉浸式的场景卡片选择心情，通过引导式流程记录当下，并结合性格优势进行自我赋能。

## 2. 核心模块划分 (Module Breakdown)

为了方便沟通，我们将应用划分为以下四大核心模块：

### 模块 A: 情绪入口 (Landing & Selection)
*   **对应文件**: `App.tsx`, `components/FerrisWheelCard.tsx`, `components/RoadCard.tsx`, `components/DeepSeaCard.tsx`
*   **功能描述**:
    *   全屏垂直滚动（Snap Scroll）。
    *   **场景 1 (Euphoric/狂喜)**: 摩天轮动画，代表“升空”与“俯瞰”。
    *   **场景 2 (Stable/平稳)**: 公路/像素风动画，代表“在路上”与“前行”。
    *   **场景 3 (Depressed/低落)**: 深海气泡动画，代表“下坠”与“容纳”。
*   **交互**: 
    *   上下滑动切换场景。
    *   点击卡片进入 **模块 C (输入)**。
    *   **特殊逻辑**: 若用户选择积极情绪且未设置过优势，先拦截跳转至 **模块 B**。

### 模块 B: 力量核心 (Strength Core / Galaxy)
*   **对应文件**: `components/StrengthPicker.tsx`, `data/strengths.ts`
*   **视觉表现**: 
    *   **星系视图**: 24颗优势星围绕核心旋转。
    *   **六大扇区**: 根据 6大美德 (智慧、勇气、仁爱、公正、节制、卓越) 划分扇区。
    *   **颜色编码**: 不同美德拥有独立的色系（蓝、赤金、粉紫、青、靛青、紫）。
*   **功能流程**:
    1.  **展开**: 点击核心球体，星系展开。
    2.  **选择**: 
        *   模式一：选择“我的优势” (Current Strengths)。
        *   模式二：选择“向往特质” (Ideal Traits)。
    3.  **确认**: 保存数据至本地存储，作为后续 AI 分析的上下文。

### 模块 C: 记录与洞察 (Input & Insight)
*   **对应文件**: `components/MoodInput.tsx`, `components/CalendarView.tsx`
*   **流程步骤**:
    1.  **Step 1 捕捉 (Recording)**: 
        *   文本输入（支持动态模板：“我发现自己很[优势]...”）。
        *   多媒体支持（图片上传/预览、语音按钮占位）。
    2.  **Step 2 归因 (Categorizing)**:
        *   展示日历视图或图片预览。
        *   选择快乐源头：**世界的馈赠** (External) vs **内在的力量** (Internal)。
    3.  **Step 3 珍藏 (Insight)**:
        *   **AI 分析**: 调用 Gemini API，结合用户的优势数据生成的深度评语。
        *   **结果展示**: 拍立得风格的卡片展示，可供珍藏。

### 模块 D: 数据与配置 (Data & Config)
*   **对应文件**: `types.ts`, `data/strengths.ts`, `metadata.json`
*   **内容**:
    *   **性格优势库**: 6大分类、24项具体优势的元数据。
    *   **枚举定义**: 心情类型、快乐源头枚举。
    *   **用户数据**: `UserTraits` (当前优势/向往优势)。

## 3. 当前开发状态
- [x] 模块 A 视觉效果与动画 (摩天轮/公路/深海)。
- [x] 模块 B 星系布局重构 (完成 6 扇区布局)。
- [x] 模块 B 数据解耦 (分离至 `data/strengths.ts`)。
- [x] 模块 C 基础流程 (输入 -> 预览 -> 结果)。
- [ ] 模块 C 的 AI 真实调用 (目前代码中已集成 Gemini 但逻辑待联调)。
- [ ] 移动端适配的细节打磨。

## 4. 沟通术语约定
*   **“星系”**: 指 StrengthPicker 组件。
*   **“扇区”**: 指星系中按美德划分的区域。
*   **“卡片”**: 指首页的三个大场景卡片。
*   **“洞察页”**: 指输入流程的最后一步结果页。

## 5. AI 开发守则 (System Prompt Guidelines)
*   **Rule 1**: 修改代码前，**必须**查阅本 PRD 确认所属模块（A/B/C/D），防止功能越界。
*   **Rule 2**: 保持数据解耦。如果涉及优势列表修改，**只能**修改 `data/strengths.ts`，严禁在组件中硬编码。
*   **Rule 3**: 任何新增的页面或复杂组件，需先更新本 PRD，保持文档与代码同步。
